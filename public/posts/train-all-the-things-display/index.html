<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <meta content="#ffffff" name="theme-color" />
  <meta content="#da532c" name="msapplication-TileColor" />

  
  <link href='&#x2F;icons&#x2F;site.webmanifest' rel="manifest" />
  
  
  
  <link href='&#x2F;icons&#x2F;favicon-16x16.png' rel="icon" sizes="16x16" type="image/png" />
  
  
  <link href='&#x2F;icons&#x2F;favicon-32x32.png' rel="icon" sizes="32x32" type="image/png" />
  
  
  <link href='&#x2F;icons&#x2F;apple-icon.png' rel="apple-touch-icon" sizes="180x180" />
  

  <link href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/galleria/1.6.1/themes/folio/galleria.folio.min.css"
    rel="stylesheet" />
  <link href="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css" rel="stylesheet" />
  <link href='https:&#x2F;&#x2F;burningdaylight.io&#x2F;site.css' rel="stylesheet" />

  
  

  <title>
     burningdaylight | Train All the Things - Display 
  </title>

  <script crossorigin="anonymous" src="https://kit.fontawesome.com/201b8d5e05.js"></script>

  
</head>

<body class="has-background-white">
  
  <nav aria-label="section navigation" class="navbar is-light" role="navigation">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item has-text-weight-bold" href="/">burningdaylight</a>
        <a aria-expanded="false" aria-label="menu" class="navbar-burger burger" data-target="navMenu" role="button">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
      <div class="navbar-menu" id="navMenu">
        <div class="navbar-end has-text-centered">
          
          <a class="navbar-item" href='https:&#x2F;&#x2F;burningdaylight.io&#x2F;'>
            Home
          </a>
          
          <a class="navbar-item" href='https:&#x2F;&#x2F;burningdaylight.io&#x2F;posts'>
            Posts
          </a>
          
          <a class="navbar-item" href='https:&#x2F;&#x2F;burningdaylight.io&#x2F;docs'>
            Docs
          </a>
          
          <a class="navbar-item" href='https:&#x2F;&#x2F;git.burningdaylight.io'>
            Repos
          </a>
          
          <a class="navbar-item" href='https:&#x2F;&#x2F;youtrack.burningdaylight.io&#x2F;projects'>
            Projects
          </a>
          
          <a class="navbar-item" href='https:&#x2F;&#x2F;teamcity.burningdaylight.io&#x2F;overview.html?guest=1'>
            Builds
          </a>
          
          <a class="navbar-item" id="nav-search" title="Search" data-target="#search-modal">
            <span class="icon">
              <i class="fas fa-search"></i>
            </span>
          </a>
          <a class="navbar-item" id="dark-mode" title="Switch to dark theme">
            <span class="icon">
              <i class="fas fa-adjust"></i>
            </span>
          </a>
        </div>
      </div>
    </div>
  </nav>
  

  
  

  
<section class="section pb-0">
  <div class="container">
    <div class="columns">
      <div class="column is-8 is-offset-2">
        <article>
          <h1 class="title">Train All the Things - Display</h1>
          <h2 class="subtitle"></h2>
          <div class="columns is-multiline is-gapless">
            <div class="column is-8">
              
  <p class="has-text-grey">
    <span class="icon">
      <i class="fas fa-user"></i>
    </span>
     published on
    <span class="icon">
      <i class="far fa-calendar-alt"></i>
    </span>
    <time datetime='2020-03-05'>March 05, 2020</time>
  </p>

            </div>
            <div class="column is-4 has-text-right-desktop">
              
  <p class="has-text-grey">
    <span class="icon">
      <i class="far fa-clock"></i>
    </span>
    3 min,
    <span class="icon">
      <i class="fas fa-pencil-alt"></i>
    </span>
    494 words
  </p>

            </div>
            <div class="column is-4">
              
            </div>
            <div class="column is-8 has-text-right-desktop">
               
  <p>
    <span class="has-text-black has-text-weight-normal">Tags:</span>
    
      <a class="link has-text-weight-light" href='https:&#x2F;&#x2F;burningdaylight.io&#x2F;tags&#x2F;hackaday&#x2F;'>
        <span class="icon is-small">
          <i class="fas fa-tag fa-xs"></i>
        </span>
        hackaday
      </a>
    
      <a class="link has-text-weight-light" href='https:&#x2F;&#x2F;burningdaylight.io&#x2F;tags&#x2F;machine-learning&#x2F;'>
        <span class="icon is-small">
          <i class="fas fa-tag fa-xs"></i>
        </span>
        machine learning
      </a>
    
      <a class="link has-text-weight-light" href='https:&#x2F;&#x2F;burningdaylight.io&#x2F;tags&#x2F;train-all-the-things&#x2F;'>
        <span class="icon is-small">
          <i class="fas fa-tag fa-xs"></i>
        </span>
        train all the things
      </a>
    
      <a class="link has-text-weight-light" href='https:&#x2F;&#x2F;burningdaylight.io&#x2F;tags&#x2F;circuitpython&#x2F;'>
        <span class="icon is-small">
          <i class="fas fa-tag fa-xs"></i>
        </span>
        circuitpython
      </a>
    
  </p>
 
            </div>
          </div>
          <div class="content has-text-justified">
            <p>Continuing my project with things I know the PyPortal display was up next. Last
year I spent a few weeks playing with the portal to make a badge at Gen Con and
had a lot of fun with it. Since that time
<a href="https://circuitpython.org/downloads">CircuitPython 5</a> has been released and
the portal now expects a few new <a href="https://circuitpython.org/libraries">modules</a>
which were easy enough to download and send to the board. The PyPortal makes it
incredibly easy to point at an endpoint to fetch data:</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#cd74e8;">import </span><span style="color:#abb2bf;">board
</span><span style="color:#cd74e8;">from </span><span style="color:#abb2bf;">adafruit_pyportal </span><span style="color:#cd74e8;">import </span><span style="color:#abb2bf;">PyPortal

pyportal </span><span style="color:#adb7c9;">= </span><span style="color:#eb6772;">PyPortal</span><span style="color:#abb2bf;">(
    </span><span style="color:#eb6772;">url</span><span style="color:#adb7c9;">=&lt;</span><span style="color:#abb2bf;">your url here</span><span style="color:#adb7c9;">&gt;</span><span style="color:#abb2bf;">,
    </span><span style="color:#eb6772;">default_bg</span><span style="color:#adb7c9;">=</span><span style="color:#9acc76;">&quot;green.bmp&quot;
</span><span style="color:#abb2bf;">)

status </span><span style="color:#adb7c9;">= </span><span style="color:#abb2bf;">pyportal.</span><span style="color:#eb6772;">fetch</span><span style="color:#abb2bf;">()
</span><span style="color:#5ebfcc;">print</span><span style="color:#abb2bf;">(status)
</span></code></pre>
<p>With that small snippet we have our status, and all we need to do is put that
in a loop to set the background depending on the bit returned.</p>
<pre style="background-color:#2b303b;">
<code><span style="color:#cd74e8;">import </span><span style="color:#abb2bf;">board
</span><span style="color:#cd74e8;">from </span><span style="color:#abb2bf;">time </span><span style="color:#cd74e8;">import </span><span style="color:#abb2bf;">sleep
</span><span style="color:#cd74e8;">from </span><span style="color:#abb2bf;">adafruit_pyportal </span><span style="color:#cd74e8;">import </span><span style="color:#abb2bf;">PyPortal

</span><span style="color:#cd74e8;">try</span><span style="color:#abb2bf;">:
    </span><span style="color:#cd74e8;">from </span><span style="color:#abb2bf;">secrets </span><span style="color:#cd74e8;">import </span><span style="color:#abb2bf;">secrets  </span><span style="font-style:italic;color:#5f697a;"># noqa
</span><span style="color:#cd74e8;">except </span><span style="color:#abb2bf;">ImportError:
    </span><span style="color:#5ebfcc;">print</span><span style="color:#abb2bf;">(</span><span style="color:#9acc76;">&quot;WiFi secrets are kept in secrets.py, please add them there!&quot;</span><span style="color:#abb2bf;">)
    </span><span style="color:#cd74e8;">raise

</span><span style="color:#abb2bf;">pyportal </span><span style="color:#adb7c9;">= </span><span style="color:#eb6772;">PyPortal</span><span style="color:#abb2bf;">(
    </span><span style="color:#eb6772;">url</span><span style="color:#adb7c9;">=</span><span style="color:#abb2bf;">secrets[</span><span style="color:#9acc76;">&quot;signal&quot;</span><span style="color:#abb2bf;">],
    </span><span style="color:#eb6772;">default_bg</span><span style="color:#adb7c9;">=</span><span style="color:#9acc76;">&quot;green.bmp&quot;
</span><span style="color:#abb2bf;">)

current </span><span style="color:#adb7c9;">= </span><span style="color:#db9d63;">0

</span><span style="color:#cd74e8;">while </span><span style="color:#db9d63;">True</span><span style="color:#abb2bf;">:
    status </span><span style="color:#adb7c9;">= </span><span style="color:#5ebfcc;">int</span><span style="color:#abb2bf;">(pyportal.</span><span style="color:#eb6772;">fetch</span><span style="color:#abb2bf;">())
    </span><span style="color:#cd74e8;">if </span><span style="color:#abb2bf;">status </span><span style="color:#adb7c9;">== </span><span style="color:#db9d63;">0 </span><span style="color:#cd74e8;">and </span><span style="color:#abb2bf;">status </span><span style="color:#adb7c9;">== </span><span style="color:#abb2bf;">current:
        </span><span style="color:#cd74e8;">pass
    elif </span><span style="color:#abb2bf;">status </span><span style="color:#adb7c9;">== </span><span style="color:#db9d63;">0 </span><span style="color:#cd74e8;">and </span><span style="color:#abb2bf;">status </span><span style="color:#adb7c9;">!= </span><span style="color:#abb2bf;">current:
        pyportal.</span><span style="color:#eb6772;">set_background</span><span style="color:#abb2bf;">(</span><span style="color:#9acc76;">&quot;green.bmp&quot;</span><span style="color:#abb2bf;">)
        current </span><span style="color:#adb7c9;">= </span><span style="color:#db9d63;">0
    </span><span style="color:#cd74e8;">elif </span><span style="color:#abb2bf;">status </span><span style="color:#adb7c9;">== </span><span style="color:#db9d63;">1 </span><span style="color:#cd74e8;">and </span><span style="color:#abb2bf;">status </span><span style="color:#adb7c9;">!= </span><span style="color:#abb2bf;">current:
        pyportal.</span><span style="color:#eb6772;">set_background</span><span style="color:#abb2bf;">(</span><span style="color:#9acc76;">&quot;red.bmp&quot;</span><span style="color:#abb2bf;">)
        current </span><span style="color:#adb7c9;">= </span><span style="color:#db9d63;">1
    </span><span style="color:#cd74e8;">elif </span><span style="color:#abb2bf;">status </span><span style="color:#adb7c9;">== </span><span style="color:#db9d63;">1 </span><span style="color:#cd74e8;">and </span><span style="color:#abb2bf;">status </span><span style="color:#adb7c9;">== </span><span style="color:#abb2bf;">current:
        </span><span style="color:#cd74e8;">pass
    </span><span style="color:#eb6772;">sleep</span><span style="color:#abb2bf;">(</span><span style="color:#db9d63;">30</span><span style="color:#abb2bf;">)
</span></code></pre>
<p>Even though it's a small snippet I want to point out a couple things. First I'm
wrapping the return from <code>fetch</code> in a cast to <code>int</code>. If you use Python,  but you
are new to CircuitPython this may seem odd. If you don't do this and try to
compare a <code>string</code> to an <code>int</code> you're probably not going to get the result you
expect. Try it out in a repl and then follow up with
<a href="https://learn.adafruit.com/circuitpython-essentials/circuitpython-essentials">CircuitPython Essentials</a>
. Also I'm only changing the background if the status we fetch is different than
the current status. While repainting the screen is fast, it's noticeable and
there's no reason to do it every 30 seconds if nothing is different.</p>
<p>That's it. Now whenever the endpoint receives an update the portal will see
that status change and update the display.</p>
<p><img src="/images/on-air-display-red.jpg" alt="Train all the Things Display Red" />
<img src="/images/on-air-display-green.jpg" alt="Train all the Things Display Green" /></p>
<p>Thanks to Adafruit for publishing the
<a href="https://www.thingiverse.com/search?q=pyportal&amp;dwh=915e616a3fbda6e">case</a> above.
The logo on display is the Jolly Wrencher of
<a href="https://hackaday.com/about/">Hackaday</a>.</p>
<p>With the <a href="https://burningdaylight.io/posts/train-all-the-things-sighandler/">endpoint</a> and display done
I'm off into the unknown. I'll be setting up the ESP-EYE to update the endpoint,
training the voice model and finally running it all with FreeRTOS.</p>
<p>The code, docs, images etc for the project can be found
<a href="https://git.burningdaylight.io/on-air">here</a> and I'll be posting updates as I
continue along to <a href="https://hackaday.io/project/170228-on-air">HackadayIO</a> and
this blog. If you have any questions or ideas reach
<a href="mailto:n0mn0m@burningdaylight.io">out</a>.</p>

          </div>
        </article>
      </div>
      
    </div>
  </div>
</section>


  
  <section class="modal" id="search-modal">
    <div class="modal-background"></div>
    <div class="modal-content">
      <div class="field">
        <p class="control has-icons-right">
          <input class="input" id="search" placeholder="Search this website." type="search" />
          <span class="icon is-small is-right">
            <i class="fas fa-search"></i>
          </span>
        </p>
      </div>
      <div class="search-results">
        <div class="search-results__items"></div>
      </div>
    </div>
    <button aria-label="close" class="modal-close is-large"></button>
  </section>
  


   
<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <nav class="level">
          
          <div class="level-item has-text-centered">
            <a
              class="button is-black is-outlined"
              href="https:&#x2F;&#x2F;burningdaylight.io&#x2F;posts&#x2F;train-all-the-things-data-generation&#x2F;"
            >
              <span class="icon mr-2">
                <i class="fas fa-arrow-circle-left"></i>
              </span>
              Train All the Things - Synthetic Generation
            </a>
          </div>
           
          <div class="level-item has-text-centered">
            <a
              class="button is-black is-outlined"
              href="https:&#x2F;&#x2F;burningdaylight.io&#x2F;posts&#x2F;train-all-the-things-sighandler&#x2F;"
            >
              Train All the Things - Signaling<span class="icon ml-2">
                <i class="fas fa-arrow-circle-right"></i>
              </span>
            </a>
          </div>
            
        </nav>
      </div>
    </div>
  </div>
</section>
 

    

  
  <footer class="py-4 has-background-light">
    <p class="has-text-centered">
      Built with
      <span class="icon is-small">
        <i class="fas fa-code fa-xs"></i>
      </span>
      code and
      <span class="icon is-small">
        <i class="fas fa-heart fa-xs"></i>
      </span>
      love <br /> Powered By
      <span class="icon is-small">
        <i class="fas fa-power-off fa-xs"></i>
      </span>
      Zola <br />Posts licensed by <a href="https://creativecommons.org/publicdomain/zero/1.0/">Creative Commons CC0 1.0 </a><i class="fa fa-cc"></i>
      <br /> Code licensed <a href="https://www.gnu.org/licenses/lgpl-3.0.txt">LGPL</a>
    </p>
  </footer>
  

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sharer.js@latest/sharer.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/galleria/1.6.1/galleria.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1/dist/chart.xkcd.min.js"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/galleria/1.6.1/themes/folio/galleria.folio.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js"></script>
  <script src='https:&#x2F;&#x2F;burningdaylight.io&#x2F;search_index.en.js'></script>
  <script src='https:&#x2F;&#x2F;burningdaylight.io&#x2F;js&#x2F;site.js'></script>

    
</body>

</html>